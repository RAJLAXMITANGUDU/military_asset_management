(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[313],{859:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});var l=a(9360);let s=e=>l.A.get(e).then(e=>e.data)},1029:(e,t,a)=>{"use strict";a.d(t,{Ay:()=>d,ri:()=>n,WG:()=>r});let l=()=>{localStorage.removeItem("token"),localStorage.removeItem("role"),localStorage.removeItem("baseId")},s=(0,a(1990).Z0)({name:"auth",initialState:{token:null,role:null,baseId:null},reducers:{setToken(e,t){e.token=t.payload.token,e.role=t.payload.role,e.baseId=t.payload.baseId},logout(e){e.token=null,e.role=null,e.baseId=null,l()}}}),{setToken:r,logout:n}=s.actions,d=s.reducer},3127:(e,t,a)=>{"use strict";a.d(t,{A:()=>d});var l=a(1990),s=a(1029);let r={};{let e=localStorage.getItem("token");r={auth:{token:e,role:localStorage.getItem("role"),baseId:localStorage.getItem("baseId")}}}let n=(0,l.U1)({reducer:{auth:s.Ay},preloadedState:r});n.subscribe(()=>{let{token:e,role:t,baseId:a}=n.getState().auth;localStorage.setItem("token",e||""),localStorage.setItem("role",t||""),localStorage.setItem("baseId",a||"")});let d=n},9360:(e,t,a)=>{"use strict";a.d(t,{A:()=>n});var l=a(3464),s=a(3127);let r=l.A.create({baseURL:"http://localhost:3000/api"});r.interceptors.request.use(e=>{let t=s.A.getState().auth.token;return t&&(e.headers.Authorization="Bearer ".concat(t)),e});let n=r},9679:(e,t,a)=>{Promise.resolve().then(a.bind(a,9939))},9939:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>o});var l=a(5155),s=a(2115),r=a(4953),n=a(7948),d=a(859);function i(){let[e,t]=(0,s.useState)(""),[a,i]=(0,s.useState)(""),[o,c]=(0,s.useState)(1),{data:u}=(0,r.Ay)("/api/purchases",d.A),{data:m}=(0,r.Ay)("/api/bases",d.A),{data:h}=(0,r.Ay)("/api/equipment-types",d.A),p=async l=>{l.preventDefault();try{await (0,d.A)("/api/purchases",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({baseId:e,equipmentTypeId:a,quantity:o})}),(0,n.j)("/api/purchases"),t(""),i(""),c(1)}catch(e){console.error("Purchase failed",e)}};return(0,l.jsxs)("div",{className:"p-4",children:[(0,l.jsx)("h1",{className:"text-2xl mb-4",children:"Purchases"}),(0,l.jsx)("form",{onSubmit:p,className:"mb-6 p-4 bg-white shadow rounded",children:(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Base"}),(0,l.jsxs)("select",{value:e,onChange:e=>t(e.target.value),className:"w-full border p-2 rounded",required:!0,children:[(0,l.jsx)("option",{value:"",children:"Select Base"}),null==m?void 0:m.map(e=>(0,l.jsx)("option",{value:e._id,children:e.name},e._id))]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Equipment"}),(0,l.jsxs)("select",{value:a,onChange:e=>i(e.target.value),className:"w-full border p-2 rounded",required:!0,children:[(0,l.jsx)("option",{value:"",children:"Select Equipment"}),null==h?void 0:h.map(e=>(0,l.jsx)("option",{value:e._id,children:e.name},e._id))]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Quantity"}),(0,l.jsx)("input",{type:"number",min:"1",value:o,onChange:e=>c(e.target.value),className:"w-full border p-2 rounded",required:!0})]}),(0,l.jsx)("div",{className:"flex items-end",children:(0,l.jsx)("button",{type:"submit",className:"w-full bg-green-600 text-white p-2 rounded",children:"Record Purchase"})})]})}),(0,l.jsx)("div",{className:"bg-white shadow rounded overflow-hidden",children:(0,l.jsxs)("table",{className:"min-w-full",children:[(0,l.jsx)("thead",{className:"bg-gray-100",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"p-3 text-left",children:"Date"}),(0,l.jsx)("th",{className:"p-3 text-left",children:"Base"}),(0,l.jsx)("th",{className:"p-3 text-left",children:"Equipment"}),(0,l.jsx)("th",{className:"p-3 text-left",children:"Quantity"})]})}),(0,l.jsx)("tbody",{children:null==u?void 0:u.map(e=>{var t,a;return(0,l.jsxs)("tr",{className:"border-t",children:[(0,l.jsx)("td",{className:"p-3",children:new Date(e.createdAt).toLocaleDateString()}),(0,l.jsx)("td",{className:"p-3",children:(null==(t=e.baseTo)?void 0:t.name)||e.baseTo}),(0,l.jsx)("td",{className:"p-3",children:(null==(a=e.equipmentType)?void 0:a.name)||e.equipmentType}),(0,l.jsx)("td",{className:"p-3",children:e.quantity})]},e._id)})})]})})]})}function o(){return(0,l.jsx)(i,{})}}},e=>{var t=t=>e(e.s=t);e.O(0,[990,464,953,441,684,358],()=>t(9679)),_N_E=e.O()}]);