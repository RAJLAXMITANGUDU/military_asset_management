(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[431],{859:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});var l=s(9360);let a=e=>l.A.get(e).then(e=>e.data)},1029:(e,t,s)=>{"use strict";s.d(t,{Ay:()=>d,ri:()=>r,WG:()=>n});let l=()=>{localStorage.removeItem("token"),localStorage.removeItem("role"),localStorage.removeItem("baseId")},a=(0,s(1990).Z0)({name:"auth",initialState:{token:null,role:null,baseId:null},reducers:{setToken(e,t){e.token=t.payload.token,e.role=t.payload.role,e.baseId=t.payload.baseId},logout(e){e.token=null,e.role=null,e.baseId=null,l()}}}),{setToken:n,logout:r}=a.actions,d=a.reducer},3127:(e,t,s)=>{"use strict";s.d(t,{A:()=>d});var l=s(1990),a=s(1029);let n={};{let e=localStorage.getItem("token");n={auth:{token:e,role:localStorage.getItem("role"),baseId:localStorage.getItem("baseId")}}}let r=(0,l.U1)({reducer:{auth:a.Ay},preloadedState:n});r.subscribe(()=>{let{token:e,role:t,baseId:s}=r.getState().auth;localStorage.setItem("token",e||""),localStorage.setItem("role",t||""),localStorage.setItem("baseId",s||"")});let d=r},5329:(e,t,s)=>{Promise.resolve().then(s.bind(s,8177))},8177:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>o});var l=s(5155),a=s(2115),n=s(4953),r=s(7948),d=s(859);function i(){let[e,t]=(0,a.useState)("ASSIGN"),[s,i]=(0,a.useState)(""),[o,c]=(0,a.useState)(""),[u,m]=(0,a.useState)(1),{data:h}=(0,n.Ay)("/api/assignments",d.A),{data:p}=(0,n.Ay)("/api/users?role=COMMANDER",d.A),{data:x}=(0,n.Ay)("/api/equipment-types",d.A),b=async e=>{e.preventDefault();try{await (0,d.A)("/api/assignments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({personnelId:s,equipmentTypeId:o,quantity:u})}),(0,r.j)("/api/assignments"),i(""),c(""),m(1)}catch(e){console.error("Assignment failed",e)}},g=async e=>{e.preventDefault();try{await (0,d.A)("/api/assignments/expend",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({equipmentTypeId:o,quantity:u})}),(0,r.j)("/api/assignments"),c(""),m(1)}catch(e){console.error("Expenditure failed",e)}},j=async e=>{try{await (0,d.A)("/api/assignments/".concat(e,"/return"),{method:"PATCH"}),(0,r.j)("/api/assignments")}catch(e){console.error("Return failed",e)}};return(0,l.jsxs)("div",{className:"p-4",children:[(0,l.jsx)("h1",{className:"text-2xl mb-4",children:"Assignments & Expenditures"}),(0,l.jsxs)("div",{className:"flex border-b mb-6",children:[(0,l.jsx)("button",{className:"px-4 py-2 ".concat("ASSIGN"===e?"border-b-2 border-blue-500":""),onClick:()=>t("ASSIGN"),children:"Assign Assets"}),(0,l.jsx)("button",{className:"px-4 py-2 ".concat("EXPEND"===e?"border-b-2 border-blue-500":""),onClick:()=>t("EXPEND"),children:"Record Expenditure"})]}),"ASSIGN"===e&&(0,l.jsx)("form",{onSubmit:b,className:"mb-6 p-4 bg-white shadow rounded",children:(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Personnel"}),(0,l.jsxs)("select",{value:s,onChange:e=>i(e.target.value),className:"w-full border p-2 rounded",required:!0,children:[(0,l.jsx)("option",{value:"",children:"Select Personnel"}),null==p?void 0:p.map(e=>(0,l.jsx)("option",{value:e._id,children:e.username},e._id))]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Equipment"}),(0,l.jsxs)("select",{value:o,onChange:e=>c(e.target.value),className:"w-full border p-2 rounded",required:!0,children:[(0,l.jsx)("option",{value:"",children:"Select Equipment"}),null==x?void 0:x.map(e=>(0,l.jsx)("option",{value:e._id,children:e.name},e._id))]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Quantity"}),(0,l.jsx)("input",{type:"number",min:"1",value:u,onChange:e=>m(e.target.value),className:"w-full border p-2 rounded",required:!0})]}),(0,l.jsx)("div",{className:"flex items-end",children:(0,l.jsx)("button",{type:"submit",className:"w-full bg-blue-600 text-white p-2 rounded",children:"Assign"})})]})}),"EXPEND"===e&&(0,l.jsx)("form",{onSubmit:g,className:"mb-6 p-4 bg-white shadow rounded",children:(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Equipment"}),(0,l.jsxs)("select",{value:o,onChange:e=>c(e.target.value),className:"w-full border p-2 rounded",required:!0,children:[(0,l.jsx)("option",{value:"",children:"Select Equipment"}),null==x?void 0:x.map(e=>(0,l.jsx)("option",{value:e._id,children:e.name},e._id))]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-medium mb-1",children:"Quantity"}),(0,l.jsx)("input",{type:"number",min:"1",value:u,onChange:e=>m(e.target.value),className:"w-full border p-2 rounded",required:!0})]}),(0,l.jsx)("div",{className:"flex items-end",children:(0,l.jsx)("button",{type:"submit",className:"w-full bg-red-600 text-white p-2 rounded",children:"Record Expenditure"})})]})}),(0,l.jsx)("div",{className:"bg-white shadow rounded overflow-hidden",children:(0,l.jsxs)("table",{className:"min-w-full",children:[(0,l.jsx)("thead",{className:"bg-gray-100",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)("th",{className:"p-3 text-left",children:"Personnel"}),(0,l.jsx)("th",{className:"p-3 text-left",children:"Equipment"}),(0,l.jsx)("th",{className:"p-3 text-left",children:"Quantity"}),(0,l.jsx)("th",{className:"p-3 text-left",children:"Status"}),(0,l.jsx)("th",{className:"p-3 text-left",children:"Actions"})]})}),(0,l.jsx)("tbody",{children:null==h?void 0:h.map(e=>{var t,s;return(0,l.jsxs)("tr",{className:"border-t",children:[(0,l.jsx)("td",{className:"p-3",children:(null==(t=e.personnelId)?void 0:t.username)||e.personnelId}),(0,l.jsx)("td",{className:"p-3",children:(null==(s=e.equipmentType)?void 0:s.name)||e.equipmentType}),(0,l.jsx)("td",{className:"p-3",children:e.quantity}),(0,l.jsx)("td",{className:"p-3",children:(0,l.jsx)("span",{className:"px-2 py-1 rounded text-xs ".concat("ASSIGNED"===e.status?"bg-green-100 text-green-800":"RETURNED"===e.status?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:e.status})}),(0,l.jsx)("td",{className:"p-3",children:"ASSIGNED"===e.status&&(0,l.jsx)("button",{onClick:()=>j(e._id),className:"text-blue-600 hover:underline",children:"Mark Returned"})})]},e._id)})})]})})]})}function o(){return(0,l.jsx)(i,{})}},9360:(e,t,s)=>{"use strict";s.d(t,{A:()=>r});var l=s(3464),a=s(3127);let n=l.A.create({baseURL:"http://localhost:3000/api"});n.interceptors.request.use(e=>{let t=a.A.getState().auth.token;return t&&(e.headers.Authorization="Bearer ".concat(t)),e});let r=n}},e=>{var t=t=>e(e.s=t);e.O(0,[990,464,953,441,684,358],()=>t(5329)),_N_E=e.O()}]);