(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[454],{1029:(e,a,r)=>{"use strict";r.d(a,{Ay:()=>n,ri:()=>o,WG:()=>s});let t=()=>{localStorage.removeItem("token"),localStorage.removeItem("role"),localStorage.removeItem("baseId")},l=(0,r(1990).Z0)({name:"auth",initialState:{token:null,role:null,baseId:null},reducers:{setToken(e,a){e.token=a.payload.token,e.role=a.payload.role,e.baseId=a.payload.baseId},logout(e){e.token=null,e.role=null,e.baseId=null,t()}}}),{setToken:s,logout:o}=l.actions,n=l.reducer},3127:(e,a,r)=>{"use strict";r.d(a,{A:()=>n});var t=r(1990),l=r(1029);let s={};{let e=localStorage.getItem("token");s={auth:{token:e,role:localStorage.getItem("role"),baseId:localStorage.getItem("baseId")}}}let o=(0,t.U1)({reducer:{auth:l.Ay},preloadedState:s});o.subscribe(()=>{let{token:e,role:a,baseId:r}=o.getState().auth;localStorage.setItem("token",e||""),localStorage.setItem("role",a||""),localStorage.setItem("baseId",r||"")});let n=o},5695:(e,a,r)=>{"use strict";var t=r(8999);r.o(t,"useRouter")&&r.d(a,{useRouter:function(){return t.useRouter}})},6238:(e,a,r)=>{Promise.resolve().then(r.bind(r,7826))},7826:(e,a,r)=>{"use strict";r.r(a),r.d(a,{default:()=>n});var t=r(5155),l=r(2115),s=r(5695),o=r(9360);function n(){let[e,a]=(0,l.useState)({username:"",email:"",password:"",confirm:"",role:"COMMANDER",base:""}),[r,n]=(0,l.useState)(""),u=(0,s.useRouter)(),d=r=>{a({...e,[r.target.name]:r.target.value})},i=async a=>{if(a.preventDefault(),n(""),e.password!==e.confirm)return n("Passwords don't match");try{await o.A.post("/auth/register",{username:e.username,email:e.email,password:e.password,role:e.role,base:"COMMANDER"===e.role?e.base:void 0}),u.push("/login")}catch(e){var r,t;n((null==(t=e.response)||null==(r=t.data)?void 0:r.message)||"Registration failed")}};return(0,t.jsxs)("div",{className:"max-w-md mx-auto p-4 mt-16 bg-white shadow rounded",children:[(0,t.jsx)("h2",{className:"text-2xl mb-4",children:"Register"}),r&&(0,t.jsx)("p",{className:"text-red-500 mb-2",children:r}),(0,t.jsxs)("form",{onSubmit:i,className:"space-y-3",children:[(0,t.jsx)("input",{name:"username",placeholder:"Username",required:!0,value:e.username,onChange:d,className:"w-full border p-2"}),(0,t.jsx)("input",{name:"email",type:"email",placeholder:"Email",required:!0,value:e.email,onChange:d,className:"w-full border p-2"}),(0,t.jsxs)("select",{name:"role",value:e.role,onChange:d,className:"w-full border p-2",children:[(0,t.jsx)("option",{value:"ADMIN",children:"Admin"}),(0,t.jsx)("option",{value:"LOGISTICS",children:"Logistics"}),(0,t.jsx)("option",{value:"COMMANDER",children:"Commander"})]}),"COMMANDER"===e.role&&(0,t.jsx)("input",{name:"base",placeholder:"Base ID",required:!0,value:e.base,onChange:d,className:"w-full border p-2"}),(0,t.jsx)("input",{name:"password",type:"password",placeholder:"Password",required:!0,value:e.password,onChange:d,className:"w-full border p-2"}),(0,t.jsx)("input",{name:"confirm",type:"password",placeholder:"Confirm Password",required:!0,value:e.confirm,onChange:d,className:"w-full border p-2"}),(0,t.jsx)("button",{className:"w-full bg-blue-600 text-white p-2 rounded",children:"Register"})]})]})}},9360:(e,a,r)=>{"use strict";r.d(a,{A:()=>o});var t=r(3464),l=r(3127);let s=t.A.create({baseURL:"http://localhost:3000/api"});s.interceptors.request.use(e=>{let a=l.A.getState().auth.token;return a&&(e.headers.Authorization="Bearer ".concat(a)),e});let o=s}},e=>{var a=a=>e(e.s=a);e.O(0,[990,464,441,684,358],()=>a(6238)),_N_E=e.O()}]);